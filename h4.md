# Harjoitus 4

## Harjoituksen tarkoitus

Harjoituksen tarkoituksena on vuokrata julkinen palvelin ja sille nimi.

Sainkin jo tunnilla tehtyä vuokrauksen ja domain varauksen, joten näiden teosta ei valitettavasti ole kuvia. Itse palvelimen vuokrasin Digitaloceanilta ja nimen NameCheapilta. Palvelimen speksit alla olevassa kuvassa. Domainin osoite taas on leikas.me 

![Image](/palvelin/palvelin.png "default")

Pääsin palvelimeen omalta virtuaalikoneeltani SSH:n kautta. Ajoin sille tarvittavat komennot; palomuurin asennus, reiät palomuuriin, Apache2 asennus, palomuurin käynnistys ja kaikkien ohjelmien päivitys.

>sudo apt-get install ufw
>
>sudo ufw allow 22/tcp
>
>sudo ufw allow 80/tcp
>
>sudo ufw enable
>
>sudo apt-get install apache2
>
>sudo apt-get -y dist-upgrade

Portti 22 mahdollistaa SSH:n käytön, portinsiirron ja kirjautumiset. Portti 80 mahdollistaa HTTP-protokollan. 

Loin koneelle uuden käyttäjän ja annoin sille sudo-oikeudet.

>sudo adduser sampsa
>
>usermod sudo sampsa

Asensin vielä Nanon ja Micron tekstinkäsittelyyn ja pistin Apachen käyttäjähakemistot päälle.

>sudo apt-install nano
>
>sudo apt-install micro
>
>sudo a2enmod userdir
>
>sudo systemctl restart apache2

Käydään korvaamassa oletussivu omalla tekstillä. Eli hakemistoon /var/www/html.

>micro index.html

Korvataan kaikki teksti 'Testisivu' tekstillä ja käydään tarkastamassa.

![Image](/palvelin/testisivu.png "default")

Käydään vielä tekemässä käyttäjälle oma sivu. Navigoidaan siis hakemistoon /home/sampsa . Luodaan sinne uusi html kansio ja index.html

>mkdir public_html
>
>micro index.html

![Image](/palvelin/kayttajansivu.png "default")


## Lokit

Käydäänpä vähän tutkimassa murtautumisyrityksiä palvelimelle, sillä niitä on paljon. Aloitetaan asentamalla whois, jotta voimme tutkia pyyntöjä ja mistä ne tulevat.

>sudo apt-get install whois
>

Navigoidaan lokeihin /var/log ja katsotaan auth.log tietuetta. Se onkin täynnä pyyntöjä näennäisin satunnaisista osotteista. Valitaanpa lokista sattumanvaraisesti joku, joka on yrittänyt kirjautua roottiin useamman kerran ja tutkitaan hänet whois komennolla.

![Image](/palvelin/attacker.png "default")

>whois 112.85.42.124

![Image](/palvelin/attacker1.png "default")

## Lähteet

1. Palvelin ja domain:
    * Palvelin: https://www.digitalocean.com/
    * Nimi: https://nc.me/
    * Oma url: http://www.leikas.me/ 
2. Hakemistoista ja lokeista: